{
    "Version": "2012-10-17",
    "Statement": [
      {
        "Condition": {
          "Bool": {
            "iot:Connection.Thing.IsAttached": "true"
          }
        },
        "Effect": "Allow",
        "Action": "iot:Connect",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':client/${iot:Connection.Thing.ThingName}"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Publish",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topic/${iot:Connection.Thing.ThingName}/telemetry"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Subscribe",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topicfilter/${iot:Connection.Thing.ThingName}/downlink"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Receive",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topic/${iot:Connection.Thing.ThingName}/downlink"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Publish",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topic/$aws/things/${iot:Connection.Thing.ThingName}/*"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Subscribe",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topicfilter/$aws/things/${iot:Connection.Thing.ThingName}/*"
      },
      {
        "Effect": "Allow",
        "Action": "iot:Receive",
        "Resource": "arn:aws:iot:eu-central-1:'your-AWS-id':topic/$aws/things/${iot:Connection.Thing.ThingName}/*"
      }
    ]
  }